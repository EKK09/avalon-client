(function(e){function t(t){for(var r,s,i=t[0],c=t[1],u=t[2],l=0,E=[];l<i.length;l++)s=i[l],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&E.push(a[s][0]),a[s]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);d&&d(t);while(E.length)E.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var i=n[s];0!==a[i]&&(r=!1)}r&&(o.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},s={1:0},a={1:0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{2:"aea2a0d0",3:"3f0978d1"}[e]+".js"}function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={2:1};s[e]?t.push(s[e]):0!==s[e]&&n[e]&&t.push(s[e]=new Promise((function(t,n){for(var r="css/"+({}[e]||e)+"."+{2:"6b33010f",3:"31d6cfe0"}[e]+".css",a=c.p+r,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var u=o[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===r||l===a))return t()}var E=document.getElementsByTagName("style");for(i=0;i<E.length;i++){u=E[i],l=u.getAttribute("data-href");if(l===r||l===a)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||a,o=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=r,delete s[e],d.parentNode.removeChild(d),n(o)},d.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){s[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=o);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=i(e);var E=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;E.message="Loading chunk "+e+" failed.\n("+r+": "+s+")",E.name="ChunkLoadError",E.type=r,E.request=s,n[1](E)}a[e]=void 0}};var d=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var E=0;E<u.length;E++)t(u[E]);var d=l;o.push([0,0]),n()})({0:function(e,t,n){e.exports=n("2f39")},"0373":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return c}));const r={UNKNOWN:"UNKNOWN",SERVANT:"SERVANT",MINION:"MINION",MERLIN:"MERLIN",PERCIVAL:"PERCIVAL",ASSASSIN:"ASSASSIN",MORGANA:"MORGANA",OBERON:"OBERON",MORDRED:"MORDRED",GOOD:"GOOD",EVIL:"EVIL"},s={UNKNOWN:"未知",SERVANT:"忠臣",MINION:"爪牙",MERLIN:"梅林",PERCIVAL:"派西維爾",ASSASSIN:"刺客",MORGANA:"魔甘娜",OBERON:"奧柏倫",MORDRED:"莫德雷德",GOD:"湖中女神",GOOD:"正義陣營",EVIL:"邪惡陣營"},a={UNKNOWN:"unknown.jpg",SERVANT:"servant.jpg",MINION:"minion.jpg",MERLIN:"merlin.jpg",PERCIVAL:"percival.jpg",ASSASSIN:"assassin.jpg",MORGANA:"morcana.jpg",OBERON:"oberon.jpg",MORDRED:"mordred.jpg",GOD:"god.jpg",GOOD:"good.jpg",EVIL:"evil.jpg"},o={SERVANT:"(正義方)沒有能力的正義方角色，共有5張牌。",MINION:"(邪惡方)沒有能力的邪惡方角色，共有3張牌。",MERLIN:"(正義方)擁有知道所有邪惡方陣營玩家的能力，但不知道【莫德雷德】是誰。如果最後被【刺客】刺殺，邪惡方就會獲勝。",PERCIVAL:"(正義方)在遊戲開始時的辨識身份階段，可以知道誰是【梅林】。",ASSASSIN:"(邪惡方)當遊戲結束，邪惡方失敗時，可以刺殺【梅林】來反敗為勝。",MORGANA:"(邪惡方)在遊戲開始時的辨識身份階段，可以假扮成【梅林】，混淆【派西維爾】。",OBERON:"(邪惡方)屬於邪惡方角色，但是邪惡方陣營的玩家不曉得他的身份，他也不知道其他邪惡方的角色是誰。",MORDRED:"(邪惡方)可以不被【梅林】看到。",GOD:"遊戲開始時，將湖中女神給領袖右邊的玩家。第2、3、4回合，出完任務後才可以使用湖中女神能力。持有湖中女神指示物的玩家選擇要檢視的對象，但是不可以選擇之前被湖中女神能力看過的玩家。"},i=e=>e===r.UNKNOWN?a.UNKNOWN:e===r.SERVANT?a.SERVANT:e===r.MINION?a.MINION:e===r.MERLIN?a.MERLIN:e===r.PERCIVAL?a.PERCIVAL:e===r.ASSASSIN?a.ASSASSIN:e===r.MORGANA?a.MORGANA:e===r.OBERON?a.OBERON:e===r.MORDRED?a.MORDRED:e===r.EVIL?a.EVIL:e===r.GOOD?a.GOOD:a.UNKNOWN,c=e=>e===r.SERVANT?s.SERVANT:e===r.MINION?s.MINION:e===r.MERLIN?s.MERLIN:e===r.PERCIVAL?s.PERCIVAL:e===r.ASSASSIN?s.ASSASSIN:e===r.MORGANA?s.MORGANA:e===r.OBERON?s.OBERON:e===r.MORDRED?s.MORDRED:e===r.EVIL?s.EVIL:e===r.GOOD?s.GOOD:s.UNKNOWN},"2f39":function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"isLeader",(function(){return y})),n.d(r,"isTaskTeam",(function(){return g})),n.d(r,"isValidGamePlayerCount",(function(){return h})),n.d(r,"isSelectedTaskTeamPlayer",(function(){return P})),n.d(r,"isTaskTeamPlayer",(function(){return v})),n.d(r,"userRoleImage",(function(){return C})),n.d(r,"hasBasicGameInfo",(function(){return M})),n.d(r,"isHost",(function(){return D})),n.d(r,"isStarted",(function(){return G})),n.d(r,"isShowGameDialog",(function(){return w})),n.d(r,"isShowLoginDialog",(function(){return k})),n.d(r,"isShowConnectingDialog",(function(){return V})),n.d(r,"playerOrder",(function(){return b})),n.d(r,"isGoodWin",(function(){return U}));var s={};n.r(s),n.d(s,"setRoomId",(function(){return W})),n.d(s,"setUser",(function(){return $})),n.d(s,"setGameOver",(function(){return Y})),n.d(s,"setMerlinKilled",(function(){return B})),n.d(s,"setIsConnectingGame",(function(){return x})),n.d(s,"setIsShowInviteDialog",(function(){return F})),n.d(s,"resetBasicGameInfo",(function(){return J})),n.d(s,"setRole",(function(){return z})),n.d(s,"setLeader",(function(){return H})),n.d(s,"resetMessage",(function(){return q})),n.d(s,"addMessage",(function(){return X})),n.d(s,"shiftMessage",(function(){return Z})),n.d(s,"setStatus",(function(){return Q})),n.d(s,"setPlayerList",(function(){return ee})),n.d(s,"addPlayer",(function(){return te})),n.d(s,"setOfflinePlayerList",(function(){return ne})),n.d(s,"addOfflinePlayer",(function(){return re})),n.d(s,"removeOfflinePlayer",(function(){return se})),n.d(s,"updatePlayerRole",(function(){return ae})),n.d(s,"revealAllPlayer",(function(){return oe})),n.d(s,"revealAssassin",(function(){return ie})),n.d(s,"revealEvilRole",(function(){return ce})),n.d(s,"revealMerlin",(function(){return ue})),n.d(s,"updateUserRole",(function(){return le})),n.d(s,"setTaskTeamList",(function(){return Ee})),n.d(s,"resetTaskTeamList",(function(){return de})),n.d(s,"updateTaskResultList",(function(){return fe})),n.d(s,"setTeamSize",(function(){return Ae})),n.d(s,"setRound",(function(){return Le})),n.d(s,"setSelectedTaskTeamList",(function(){return Se})),n.d(s,"resetSelectedTaskTeamList",(function(){return Re})),n.d(s,"addSelectedTaskTeamPlayer",(function(){return Te})),n.d(s,"removeSelectedTaskTeamPlayer",(function(){return pe})),n.d(s,"setWebSocket",(function(){return me})),n.d(s,"setRevealPlayer",(function(){return _e})),n.d(s,"setKillPlayer",(function(){return Ie})),n.d(s,"setRevealedPlayerList",(function(){return Ne})),n.d(s,"setUnApproveCount",(function(){return Oe})),n.d(s,"resetUnApproveCount",(function(){return ye})),n.d(s,"incrementReconnectCount",(function(){return ge})),n.d(s,"resetReconnectCount",(function(){return he}));var a={};n.r(a),n.d(a,"createGameAction",(function(){return Me})),n.d(a,"joinGameAction",(function(){return De})),n.d(a,"startGameAction",(function(){return Ge})),n.d(a,"assignTaskTeamAction",(function(){return we})),n.d(a,"voteTaskAction",(function(){return ke})),n.d(a,"approveAction",(function(){return Ve})),n.d(a,"assignRevealPlayerAction",(function(){return be})),n.d(a,"assignGodStatementAction",(function(){return Ue})),n.d(a,"assignKillPlayerAction",(function(){return Ke})),n.d(a,"fetchGameInfoAction",(function(){return je})),n.d(a,"handleJoinGameAction",(function(){return We}));n("5319"),n("7d6e"),n("e54f"),n("985d"),n("4e2f"),n("31cd");var o=n("2b0e"),i=n("1f91"),c=n("42d2"),u=n("b05d"),l=n("2a19"),E=n("515f"),d=n("18d6"),f=n("9c64");o["a"].use(u["a"],{config:{notify:{timeout:"1000",position:"center"}},lang:i["a"],iconSet:c["a"],plugins:{Notify:l["a"],Cookies:E["a"],LocalStorage:d["a"],Meta:f["a"]}});var A=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"q-app"}},[n("router-view")],1)},L=[],S={name:"App"},R=S,T=n("2877"),p=Object(T["a"])(R,A,L,!1,null,null,null),m=p.exports,_=n("2f62"),I=n("0373"),N=n("6ffa");function O(){return{roomId:"",user:"",role:I["a"].UNKNOWN,leader:"",playerList:[],taskTeamList:[],taskResultList:[],messageList:["等待玩家就位，遊戲人數 5 ~ 10"],status:N["a"].WAIT_START,selectedTaskTeamList:[],teamSize:0,round:0,webSocket:null,revealPlayer:"",killPlayer:"",revealedPlayerList:[],unApproveCount:0,offlinePlayerList:[],isGameOver:!1,isMerlinKilled:!1,isConnectingGame:!1,isShowInviteDialog:!1,reconnectCount:0}}function y(e){return t=>e.leader===t}function g(e){return e.taskTeamList.includes(e.user)}function h(e){const t=e.playerList.length;return t>=5&&t<=10}function P(e){return t=>e.selectedTaskTeamList.includes(t)}function v(e){return t=>e.taskTeamList.includes(t)}function C(e){return Object(I["e"])(e.role)}function M(e){return""!==e.roomId&&""!==e.user}function D(e){const t=e.playerList[0];return void 0!==t&&t.name===e.user}function G(e){return e.round>0}function w(e){return!e.isGameOver&&e.offlinePlayerList.length>0}function k(e){return!e.isGameOver&&(""===e.roomId||""===e.user)}function V(e){return!e.isGameOver&&(!(!e.roomId||!e.user)&&null===e.webSocket)}function b(e){return t=>{for(let n=0;n<e.playerList.length;n+=1){const r=e.playerList[n];if(r.name===t)return n+1}return 0}}function U(e){return 5!==e.unApproveCount&&!e.isMerlinKilled&&e.taskResultList.filter((e=>!!e)).length>=3}var K=n("ded3"),j=n.n(K);function W(e,t){e.roomId=t}function $(e,t){e.user=t}function Y(e){e.isGameOver=!0}function B(e){e.isMerlinKilled=!0}function x(e,t){e.isConnectingGame=t}function F(e,t){e.isShowInviteDialog=t}function J(e){e.roomId="",e.user=""}function z(e,t){e.role=t}function H(e,t){e.leader=t}function q(e){e.messageList=[]}function X(e,t){const n=e.user?t.replace(e.user,"您"):t;e.messageList.push(n)}function Z(e){e.messageList.shift()}function Q(e,t){e.status=t}function ee(e,t){e.playerList=t}function te(e,t){e.playerList.push({name:t,role:I["a"].UNKNOWN})}function ne(e,t){e.offlinePlayerList=t}function re(e,t){e.offlinePlayerList.push(t)}function se(e,t){for(let n=0;n<e.offlinePlayerList.length;n+=1)if(t===e.offlinePlayerList[n])return void e.offlinePlayerList.splice(n,1)}function ae(e,{name:t,role:n}){const r=e.playerList;for(let s=0;s<r.length;s+=1){const a=r[s];if(a.name===t)return void e.playerList.splice(s,1,{name:t,role:n})}}function oe(e,t){const n=e.playerList;for(let r=0;r<n.length;r+=1){const s=n[r];e.playerList.splice(r,1,{name:s.name,role:t[s.name]})}}function ie(e,t){const n=e.playerList;for(let r=0;r<n.length;r+=1){const s=n[r];if(s.name===t)return void e.playerList.splice(r,1,{name:t,role:I["a"].ASSASSIN})}}function ce(e,t){const n=e.playerList;for(let r=0;r<n.length;r+=1){const s=n[r];t.includes(s.name)&&s.role===I["a"].UNKNOWN&&e.playerList.splice(r,1,j()(j()({},s),{},{role:I["a"].EVIL}))}}function ue(e,t){const n=e.playerList;for(let r=0;r<n.length;r+=1){const s=n[r];t.includes(s.name)&&e.playerList.splice(r,1,j()(j()({},s),{},{role:I["a"].MERLIN}))}}function le(e,t){const n=e.playerList;for(let r=0;r<n.length;r+=1){const s=n[r];if(s.name===e.user)return void e.playerList.splice(r,1,{name:e.user,role:t})}}function Ee(e,t){e.taskTeamList=t}function de(e){e.taskTeamList=[]}function fe(e,t){e.taskResultList=t}function Ae(e,t){e.teamSize=t}function Le(e,t){e.round=t}function Se(e,t){e.selectedTaskTeamList=t}function Re(e){e.selectedTaskTeamList=[]}function Te(e,t){const n=e.selectedTaskTeamList.slice(0,e.teamSize-1);n.unshift(t),e.selectedTaskTeamList=n}function pe(e,t){const n=e.selectedTaskTeamList;for(let r=0;r<n.length;r+=1)if(n[r]===t)return void e.selectedTaskTeamList.splice(r,1)}function me(e,t){e.webSocket=t}function _e(e,t){e.revealPlayer=t}function Ie(e,t){e.killPlayer=t}function Ne(e,t){e.revealedPlayerList=t}function Oe(e,t){e.unApproveCount=t}function ye(e){e.unApproveCount=0}function ge(e){e.reconnectCount+=1}function he(e){e.reconnectCount=0}var Pe=n("34c9");const ve={START:"START",DECLARE_PLAYER:"DECLARE_PLAYER",DECLARE_ROUND:"DECLARE_ROUND",DECLARE_TEAM_SIZE:"DECLARE_TEAM_SIZE",DECLARE_TEAM:"DECLARE_TEAM",DECLARE_ROLE:"DECLARE_ROLE",REVEAL_EVIL:"REVEAL_EVIL",REVEAL_MERLIN:"REVEAL_MERLIN",REVEAL_EVIL_EACH:"REVEAL_EVIL_EACH",DECLARE_LEADER:"DECLARE_LEADER",ASSIGN_TEAM:"ASSIGN_TEAM",ASSIGN_TASK:"ASSIGN_TASK",VOTE:"VOTE",APPROVE:"APPROVE",DECLARE_TASK_RESULT:"DECLARE_TASK_RESULT",ASSIGN_GOD:"ASSIGN_GOD",ASSIGN_REVEAL_PLAYER:"ASSIGN_REVEAL_PLAYER",REVEAL_PLAYER:"REVEAL_PLAYER",ASSIGN_GOD_STATEMENT:"ASSIGN_GOD_STATEMENT",DECLARE_GOD_STATEMENT:"DECLARE_GOD_STATEMENT",DECLARE_TASK_LIST:"DECLARE_TASK_LIST",DECLARE_APPROVAL_RESULT:"DECLARE_APPROVAL_RESULT",DECLARE_APPROVAL_LIST:"DECLARE_APPROVAL_LIST",DECLARE_UNAPPROVAL_COUNT:"DECLARE_UNAPPROVAL_COUNT",DECLARE_REVEALED_PLAYER_LIST:"DECLARE_REVEALED_PLAYER_LIST",DECLARE_ASSASSIN:"DECLARE_ASSASSIN",DECLARE_KILL_RESULT:"DECLARE_KILL_RESULT",ASSIGN_KILL_PLAYER:"ASSIGN_KILL_PLAYER",DECLARE_GAME_RESULT:"DECLARE_GAME_RESULT",DECLARE_OFFLINE:"DECLARE_OFFLINE",DECLARE_PLAYER_RETURN:"DECLARE_PLAYER_RETURN",DECLARE_GAME_INFO:"DECLARE_GAME_INFO"},Ce={OK:100,GAME_NOT_EXIST:99,PLAYER_EXIST:98,GAME_HAS_START:97,NO_SPACE:96};async function Me({dispatch:e,commit:t},{player:n,handleSuccess:r,handleError:s}){try{t("setIsConnectingGame",!0);const a={player_name:n},o=await Object(Pe["a"])(a),i=o.data.room_id;if(!i)throw new Error;e("joinGameAction",{player:n,roomId:i,handleSuccess:r,handleError:s})}catch(a){t("setIsConnectingGame",!1),s()}}async function De({commit:e,state:t,getters:n,dispatch:r},{player:s,roomId:a,handleSuccess:o,handleError:i}){try{e("setIsConnectingGame",!0);const c=`wss://avalonserver.herokuapp.com/${a}/${s}`,u=new WebSocket(c);u.addEventListener("open",(()=>{window.clearInterval(window.socketTimer),e("setWebSocket",u),e("setRoomId",a),e("setUser",s),e("setIsConnectingGame",!1),o(a),e("resetReconnectCount"),window.socketTimer=setInterval((()=>{u.send("check")}),5e4)})),u.addEventListener("message",(r=>{let s;try{if(s=JSON.parse(r.data),!s.type)throw new Error}catch(i){s=null}if(null===s)return;const{type:a,payload:o}=s;if(a===ve.DECLARE_PLAYER){const t=o.map((e=>({name:e,role:I["a"].UNKNOWN})));e("setPlayerList",t)}else if(a===ve.DECLARE_ROUND)e("setRound",o);else if(a===ve.DECLARE_ROLE)e("setRole",o),e("updateUserRole",o),e("resetMessage"),e("addMessage",`你的角色為 ${Object(I["f"])(o)}`);else if(a===ve.REVEAL_EVIL)e("revealEvilRole",o),e("addMessage",`${o.join(", ")} 為邪惡陣營`);else if(a===ve.REVEAL_MERLIN)e("revealMerlin",o),e("addMessage",`${o.join(", ")} 的身份為梅林？`);else if(a===ve.REVEAL_EVIL_EACH){e("revealEvilRole",o);const t=o.length>1?`${o.join(", ")} 為同夥`:"您沒有同夥";e("addMessage",t)}else if(a===ve.DECLARE_LEADER)e("resetSelectedTaskTeamList"),e("resetTaskTeamList"),e("setLeader",o),o===t.user?(e("addMessage",`請選擇 ${t.teamSize} 位出任務玩家`),e("setStatus",N["a"].SELECT_TASK_PLAYER)):e("addMessage",`等待 ${o} 指派玩家`);else if(a===ve.DECLARE_TEAM_SIZE)e("setTeamSize",o);else if(a===ve.DECLARE_TEAM)e("setTaskTeamList",o),e("resetMessage"),e("addMessage",`本回出任務玩家${o.join(", ")}`),e("setStatus",N["a"].APPROVE);else if(a===ve.DECLARE_TASK_RESULT){const t=`${o.failCount} 票反對，`,n=o.result?"任務成功":"任務失敗",r=t+n;e("resetMessage"),e("resetTaskTeamList"),e("resetSelectedTaskTeamList"),e("addMessage",r)}else if(a===ve.DECLARE_TASK_LIST)e("updateTaskResultList",o);else if(a===ve.ASSIGN_TASK)e("setSelectedTaskTeamList",o),o.includes(t.user)?(e("addMessage","請出任務"),e("setStatus",N["a"].VOTE)):e("addMessage",`${o.join(", ")} 出任務中`);else if(a===ve.DECLARE_GOD_STATEMENT)e("setStatus",N["a"].WAIT),e("addMessage",`${o.god} 表示 ${o.player} 是 ${o.isGood?"亞瑟的忠臣":"莫德雷德的爪牙"}`);else if(a===ve.ASSIGN_GOD){const n=t.user===o,r=n?N["a"].SELECT_REVEAL_PLAYER:N["a"].WAIT,s=n?"湖中女神出現，請選擇你想檢視的玩家":"湖中女神出現，等待湖中女神的指示";e("resetSelectedTaskTeamList"),e("resetTaskTeamList"),e("setStatus",r),e("addMessage",s)}else if(a===ve.DECLARE_REVEALED_PLAYER_LIST)e("setRevealedPlayerList",o);else if(a===ve.DECLARE_APPROVAL_LIST){e("resetMessage");const r=o.filter((e=>!e.result)).map((e=>e.player)),s=r.length<t.playerList.length/2,a=s?"投票通過":"投票不通過",i=r.length>0?`${r.join(", ")} 表示反對`:"無人反對",c=s?"任務玩家請投票":"",u=`${a},${i} ${c}`,l=s&&n.isTaskTeam?N["a"].VOTE:N["a"].WAIT;e("addMessage",u),e("setStatus",l)}else if(a===ve.REVEAL_PLAYER){e("resetMessage");const t=o.player,n=o.isGood?I["a"].GOOD:I["a"].EVIL,r=`${t} 角色是 ${o.isGood?"忠臣":"爪牙"} ，你想告訴大家？`;e("updatePlayerRole",{name:t,role:n}),e("addMessage",r),e("setStatus",N["a"].ASSIGN_GOD_STATEMENT)}else if(a===ve.DECLARE_UNAPPROVAL_COUNT)e("setUnApproveCount",o);else if(a===ve.DECLARE_ASSASSIN){e("revealAssassin",o);const n=o===t.user,r=n?N["a"].SELECT_KILL_PLAYER:N["a"].WAIT;e("setStatus",r);const s=n?"請選擇要刺殺的玩家":"",a=`刺客登場( ${o} ) ！！！ 梅林危險了 ${s}`;e("addMessage",a)}else if(a===ve.DECLARE_GAME_RESULT){const{result:n,isMerlinKilled:r,role:s}=o,a=n?"正義陣營獲勝":"邪惡陣營獲勝",i=r?"梅林遭到刺殺!!!":"",c=a+i;e("setStatus",N["a"].END),e("revealAllPlayer",s),e("addMessage",c),e("setGameOver"),t.webSocket.close()}else if(a===ve.DECLARE_OFFLINE)e("addOfflinePlayer",o);else if(a===ve.DECLARE_PLAYER_RETURN)e("removeOfflinePlayer",o);else if(a===ve.DECLARE_GAME_INFO){const{role:n,leader:r,teamSize:s,playerList:a,merlins:i,evils:c,taskList:u,unApproveCount:l,teamMemberList:E,revealedPlayerList:d,status:f,isRevealedPlayerGood:A}=o;e("setRole",n),e("setLeader",r),e("setTeamSize",s),e("setPlayerList",a.map((e=>({name:e,role:e===t.user?n:I["a"].UNKNOWN})))),e("revealMerlin",i),e("revealEvilRole",c),e("updateTaskResultList",u),e("setTaskTeamList",E),e("setUnApproveCount",l),e("setRevealedPlayerList",d),e("setStatus",f),e("resetMessage"),e("addMessage","連線成功！！"),f===N["a"].VOTE?e("addMessage","任務玩家請投票"):f===N["a"].APPROVE?e("addMessage",`本回出任務玩家${E.join(", ")}`):f===N["a"].SELECT_TASK_PLAYER?e("addMessage",`請選擇 ${s} 位出任務玩家`):f===N["a"].SELECT_REVEAL_PLAYER?e("addMessage","湖中女神出現，請選擇你想檢視的玩家"):f===N["a"].SELECT_KILL_PLAYER?e("addMessage","請選擇要刺殺的玩家"):f===N["a"].ASSIGN_GOD_STATEMENT?e("addMessage",`${d[d.length-1]} 角色是 ${A?"忠臣":"爪牙"} ，你想告訴大家？`):f===N["a"].WAIT&&e("addMessage","等待其他玩家動作")}else if(a===ve.DECLARE_KILL_RESULT){const t=o,n=t?"刺殺成功":"刺殺失敗";e("addMessage",n)}})),u.addEventListener("error",(()=>{e("setIsConnectingGame",!1),e("setWebSocket",null),window.clearInterval(window.socketTimer)})),u.addEventListener("close",(()=>{window.clearInterval(window.socketTimer),e("setIsConnectingGame",!1),e("setWebSocket",null),e("incrementReconnectCount"),t.reconnectCount<=3&&t.roomId&&t.user&&!1===t.isGameOver&&r("joinGameAction",{player:t.user,roomId:t.roomId,handleSuccess:()=>{},handleError:()=>{}}),t.user&&t.roomId||i()}))}catch(c){i(),e("setIsConnectingGame",!1)}}async function Ge({state:e,commit:t}){try{t("setStatus",N["a"].WAIT);const n={type:ve.START},r=e.webSocket;r.send(JSON.stringify(n))}catch(n){}}async function we({state:e,commit:t}){try{t("setStatus",N["a"].WAIT);const n={type:ve.ASSIGN_TEAM,payload:e.selectedTaskTeamList},r=e.webSocket;r.send(JSON.stringify(n)),t("resetSelectedTaskTeamList")}catch(n){}}async function ke({state:e,commit:t},n){try{t("setStatus",N["a"].WAIT);const r={type:ve.VOTE,payload:n},s=e.webSocket;s.send(JSON.stringify(r))}catch(r){}}async function Ve({state:e,commit:t},n){try{t("setStatus",N["a"].WAIT);const r={type:ve.APPROVE,payload:n},s=e.webSocket;s.send(JSON.stringify(r))}catch(r){}}async function be({state:e,commit:t}){try{t("setStatus",N["a"].WAIT);const n={type:ve.ASSIGN_REVEAL_PLAYER,payload:e.revealPlayer},r=e.webSocket;r.send(JSON.stringify(n))}catch(n){}}async function Ue({state:e,commit:t},n){try{t("setStatus",N["a"].WAIT);const r={god:e.user,isGood:n,player:e.revealPlayer},s={type:ve.ASSIGN_GOD_STATEMENT,payload:r},a=e.webSocket;a.send(JSON.stringify(s)),t("setRevealPlayer","")}catch(r){}}async function Ke({state:e,commit:t}){try{t("setStatus",N["a"].WAIT);const n={type:ve.ASSIGN_KILL_PLAYER,payload:e.killPlayer},r=e.webSocket;r.send(JSON.stringify(n))}catch(n){}}async function je({commit:e,getters:t},n){try{const r=await Object(Pe["c"])(n),{player_info:s,tasks:a,killed:o,un_approve_count:i}=r.data,c=Object.keys(s).map((e=>({name:e,role:s[e]})));e("setPlayerList",c),e("setUnApproveCount",i),e("updateTaskResultList",a),o&&e("setMerlinKilled"),e("setGameOver"),e("resetMessage");const u=t.isGoodWin?"遊戲結束，正義陣營獲得勝利":"遊戲結束，邪惡陣營獲得勝利",l=o?" 梅林遭到刺殺":"";e("addMessage",u+l)}catch(r){}}async function We({commit:e,dispatch:t},{roomId:n,player:r,handleSuccess:s,handleError:a}){try{e("setIsConnectingGame",!0);const o={player_name:r},i=await Object(Pe["d"])(n,o),c=i.data.join_code;if(c===Ce.GAME_NOT_EXIST)throw new Error("遊戲不存在！");if(c===Ce.PLAYER_EXIST)throw new Error(`${r}已經在遊戲中，換個名字試試吧！`);if(c===Ce.NO_SPACE)throw new Error("遊戲玩家已達上限！");if(c===Ce.GAME_HAS_START)throw new Error("遊戲進行中！");if(c!==Ce.OK)throw new Error;t("joinGameAction",{player:r,roomId:n,handleSuccess:s,handleError:a})}catch(o){a(o.message),e("setIsConnectingGame",!1)}}var $e={namespaced:!0,state:O,getters:r,mutations:s,actions:a};o["a"].use(_["a"]);var Ye=()=>{const e=new _["a"].Store({modules:{game:$e},strict:!1});return e},Be=n("8c4f");n("ddb0");const xe=[{path:"/:roomId?",component:()=>Promise.all([n.e(0),n.e(2)]).then(n.bind(null,"bda9"))},{path:"*",component:()=>Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"e51e"))}];var Fe=xe;o["a"].use(Be["a"]);var Je=function(){const e=new Be["a"]({scrollBehavior:()=>({x:0,y:0}),routes:Fe,mode:"history",base:"/"});return e},ze=async function(e){const t="function"===typeof Ye?await Ye({Vue:o["a"],ssrContext:e}):Ye,n="function"===typeof Je?await Je({Vue:o["a"],ssrContext:e,store:t}):Je;t.$router=n;const r={router:n,store:t,render:e=>e(m)};return u["a"].ssrUpdate({app:r,ssr:e}),{app:r,store:t,router:n}},He=n("a925"),qe={failed:"Action failed",success:"Action was successful"},Xe={"en-us":qe};o["a"].use(He["a"]);const Ze=new He["a"]({locale:"en-us",fallbackLocale:"en-us",messages:Xe});var Qe=({app:e})=>{e.i18n=Ze},et=n("bc3a"),tt=n.n(et);o["a"].prototype.$axios=tt.a;n("13d5");function nt(e,t){const n=e?e.matched?e:t.resolve(e).route:t.currentRoute;return n?Array.prototype.concat.apply([],n.matched.map((e=>Object.keys(e.components).map((t=>{const n=e.components[t];return{path:e.path,c:n.options||n}}))))):[]}function rt(e,t,n){e.beforeResolve(((r,s,a)=>{const o=window.location.href.replace(window.location.origin,""),i=nt(r,e),c=nt(s,e);let u=!1;const l=i.filter(((e,t)=>u||(u=!c[t]||c[t].c!==e.c||e.path.indexOf("/:")>-1))).filter((e=>e.c&&"function"===typeof e.c.preFetch)).map((e=>e.c.preFetch));if(0===l.length)return a();let E=!1;const d=e=>{E=!0,a(e)},f=()=>{!1===E&&a()};l.reduce(((e,a)=>e.then((()=>!1===E&&a({store:t,currentRoute:r,previousRoute:s,redirect:d,urlPath:o,publicPath:n})))),Promise.resolve()).then(f).catch((e=>{f()}))}))}const st="/";async function at(){const{app:e,store:t,router:n}=await ze();window.__INITIAL_STATE__&&t.replaceState(window.__INITIAL_STATE__);let r=!1;const s=e=>{r=!0;const t=Object(e)===e?n.resolve(e).route.fullPath:e;window.location.href=t},a=window.location.href.replace(window.location.origin,""),i=[Qe,void 0];for(let l=0;!1===r&&l<i.length;l++)if("function"===typeof i[l])try{await i[l]({app:e,router:n,store:t,Vue:o["a"],ssrContext:null,redirect:s,urlPath:a,publicPath:st})}catch(u){return u&&u.url?void(window.location.href=u.url):void 0}if(!0===r)return;const c=new o["a"](e);n.onReady((()=>{rt(n,t,st),c.$mount("#q-app")}))}at()},"31cd":function(e,t,n){},"34c9":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n("bc3a"),s=n.n(r);const a=s.a.create({baseURL:"https://avalonserver.herokuapp.com",headers:{"Content-Type":"application/json"}}),o=e=>{const t="/room";return a.post(t,e)},i=e=>{const t=`/game/${e}`;return a.get(t)},c=e=>{const t=`/host/${e}`;return a.get(t)},u=(e,t)=>{const n=`/join/${e}`;return a.post(n,t)}},"6ffa":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={WAIT_START:"WAIT_START",WAIT:"WAIT",VOTE:"VOTE",APPROVE:"APPROVE",SELECT_TASK_PLAYER:"SELECT_TASK_PLAYER",SELECT_REVEAL_PLAYER:"SELECT_REVEAL_PLAYER",SELECT_KILL_PLAYER:"SELECT_KILL_PLAYER",ASSIGN_GOD_STATEMENT:"ASSIGN_GOD_STATEMENT",END:"END"}}});